// Generated by CoffeeScript 1.6.2
(function() {
  var Appearance, EntireView, PAGES, PJAX, Position, REPEAT, lastPage, showNextPage, showPage, showPreviousPage;

  PAGES = 'section';

  PJAX = false;

  REPEAT = true;

  $(function() {
    var appearance, currentPosition, entireView;

    currentPosition = new Position();
    appearance = new Appearance();
    appearance.initCSS();
    showPage(currentPosition.get('page'));
    entireView = new EntireView();
    $('html').keydown(function(e) {
      switch (e.which) {
        case 38:
          e.preventDefault();
          return entireView.zoomOut();
        case 40:
          e.preventDefault();
          currentPosition.set({
            'page': showPage(currentPosition.get('page'))
          });
          return entireView.zoomIn();
        case 33:
        case 37:
        case 75:
          e.preventDefault();
          return currentPosition.set({
            'page': showPreviousPage(currentPosition.get('page'))
          });
        case 13:
        case 32:
        case 34:
        case 39:
        case 74:
          e.preventDefault();
          return currentPosition.set({
            'page': showNextPage(currentPosition.get('page'))
          });
        case 36:
        case 48:
          e.preventDefault();
          return currentPosition.set({
            'page': showPage(0)
          });
        case 35:
        case 52:
          e.preventDefault();
          return currentPosition.set({
            'page': showPage(lastPage())
          });
      }
    });
    return $(PAGES).click(function(e) {
      var clickedPage;

      e.preventDefault();
      clickedPage = $(PAGES).index($(this));
      currentPosition.set({
        'page': showPage(clickedPage)
      });
      return entireView.zoomIn();
    });
  });

  Appearance = Backbone.Model.extend({
    defaults: {
      direction: 'horizontal'
    },
    initCSS: function() {
      $('html').css('overflow', 'hidden');
      $(PAGES).parent().css({
        'display': 'flex',
        /* 
        jquery1.9.1 does not automatically add vendor prefix with 'flex'.
        and also, only Chrome supports 'flex' for now.
        */

        'display': '-webkit-flex',
        'flex-wrap': 'nowrap',
        'align-items': 'center',
        'min-width': "" + ($(PAGES).size() * 100) + "%"
      });
      return $(PAGES).css({
        'display': 'flex',
        'display': '-webkit-flex',
        'justify-content': 'space-around',
        'align-items': 'center',
        'flex-direction': 'column',
        'width': '100%',
        'min-height': $(window).height(),
        'transition': function(index, value) {
          return 'all 1s ease';
        }
      });
    }
  });

  Position = Backbone.Model.extend({
    defaults: {
      page: 0,
      level: 0
    }
  });

  EntireView = Backbone.View.extend({
    el: 'html',
    zoomIn: function() {
      return this.$el.css({
        'transform': 'scale3d(1.0, 1.0, 1.0)',
        'transition': 'transform 1s ease',
        'transition': '-webkit-transform 1s ease'
      });
    },
    zoomOut: function() {
      return this.$el.css({
        'transform': 'scale3d(0.5, 0.5, 0.5)',
        'transition': 'transform 1s ease',
        'transition': '-webkit-transform 1s ease'
      });
    }
  });

  showPreviousPage = function(page) {
    if (page > 0) {
      page--;
    } else {
      if (REPEAT) {
        page = lastPage();
      }
    }
    showPage(page);
    return page;
  };

  showNextPage = function(page) {
    if (page < lastPage()) {
      page++;
    } else {
      if (REPEAT) {
        page = 0;
      }
    }
    showPage(page);
    return page;
  };

  showPage = function(index) {
    $(PAGES).css('transform', "translateX(-" + (index * 100) + "%)");
    return index;
  };

  lastPage = function() {
    return $(PAGES).size() - 1;
  };

}).call(this);
